<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Government Payroll System</title>
<style>
body{
font-family:'Segoe UI',sans-serif;
margin:0;
background:linear-gradient(135deg,#1f4fa8,#2d6cdf);
}
.container{
width:1100px;
margin:40px auto;
background:white;
border-radius:15px;
padding:30px;
box-shadow:0 15px 40px rgba(0,0,0,0.2);
}
h1{text-align:center;color:#1f4fa8;}
input,select{
padding:8px;width:280px;margin:6px 0;
border-radius:6px;border:1px solid #ccc;
}
button{
padding:8px 15px;margin:5px;
border:none;border-radius:6px;
background:#1f4fa8;color:white;
cursor:pointer;
}
button:hover{background:#163a7a;}
.nav{text-align:center;margin-bottom:20px;}
section{display:none;}
table{width:100%;border-collapse:collapse;margin-top:15px;}
th,td{border:1px solid #ccc;padding:8px;text-align:center;}
th{background:#f4f6f9;}
.payslip{border:2px solid black;padding:20px;margin-top:20px;}
</style>
</head>
<body>

<div class="container">

<h1>Government Payroll System</h1>

<div id="authSection">
<h3>Login / Register</h3>
<input type="email" id="email" placeholder="Email"><br>
<input type="password" id="password" placeholder="Password"><br>
<button onclick="register()">Register</button>
<button onclick="login()">Login</button>
</div>

<div id="appSection" style="display:none;">

<div class="nav">
<button onclick="showSection('employee')">Employees</button>
<button onclick="showSection('payroll')">Payroll</button>
<button onclick="showSection('records')">Payslip</button>
<button onclick="logout()">Logout</button>
</div>

<section id="employee">
<h3>Add Employee</h3>
<input id="empName" placeholder="Name"><br>
<input id="empOffice" placeholder="Office"><br>
<input id="empSalary" type="number" placeholder="Monthly Salary"><br>
<button onclick="addEmployee()">Save Employee</button>

<table>
<thead>
<tr><th>Name</th><th>Office</th><th>Salary</th></tr>
</thead>
<tbody id="empTable"></tbody>
</table>
</section>

<section id="payroll">
<h3>Create Payroll</h3>
<select id="payrollEmp"></select><br>
<input id="daysWorked" type="number" placeholder="Days Worked"><br>
<input id="sss" type="number" placeholder="SSS"><br>
<input id="tax" type="number" placeholder="Tax %"><br>
<button onclick="computePayroll()">Compute & Save</button>
</section>

<section id="records">
<h3>Generate Payslip</h3>
<select id="recordEmp"></select><br>
<button onclick="generatePayslip()">Generate</button>
<div id="payslipOutput"></div>
</section>

</div>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "PASTE_YOURS",
  authDomain: "PASTE_YOURS",
  projectId: "PASTE_YOURS",
  storageBucket: "PASTE_YOURS",
  messagingSenderId: "PASTE_YOURS",
  appId: "PASTE_YOURS"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentUser = null;

window.register = async function(){
try{
await createUserWithEmailAndPassword(auth,email.value,password.value);
alert("Registered successfully!");
}catch(e){
alert(e.message);
}
}

window.login = async function(){
try{
await signInWithEmailAndPassword(auth,email.value,password.value);
alert("Login successful!");
}catch(e){
alert(e.message);
}
}

window.logout = async function(){
await signOut(auth);
}

onAuthStateChanged(auth,(user)=>{
if(user){
currentUser=user;
authSection.style.display="none";
appSection.style.display="block";
loadEmployees();
}else{
authSection.style.display="block";
appSection.style.display="none";
}
});

window.showSection=function(id){
document.querySelectorAll("section").forEach(s=>s.style.display="none");
document.getElementById(id).style.display="block";
}

window.addEmployee=async function(){
if(!empName.value||!empSalary.value)return alert("Complete fields");
await addDoc(collection(db,"users",currentUser.uid,"employees"),{
name:empName.value,
office:empOffice.value,
salary:Number(empSalary.value)
});
empName.value=""; empOffice.value=""; empSalary.value="";
loadEmployees();
alert("Employee saved!");
}

async function loadEmployees(){
empTable.innerHTML="";
payrollEmp.innerHTML="";
recordEmp.innerHTML="";
let snap=await getDocs(collection(db,"users",currentUser.uid,"employees"));
snap.forEach(doc=>{
let d=doc.data();
empTable.innerHTML+=`<tr><td>${d.name}</td><td>${d.office}</td><td>${d.salary}</td></tr>`;
payrollEmp.innerHTML+=`<option>${d.name}</option>`;
recordEmp.innerHTML+=`<option>${d.name}</option>`;
});
}

window.computePayroll=async function(){
let snap=await getDocs(collection(db,"users",currentUser.uid,"employees"));
let empData;
snap.forEach(doc=>{
if(doc.data().name==payrollEmp.value){
empData=doc.data();
}
});
if(!empData)return alert("Employee not found");

let gross=(empData.salary/22)*Number(daysWorked.value);
let phil=gross*0.05;
let net=gross-phil-Number(sss.value)-(gross*(tax.value/100));

await addDoc(collection(db,"users",currentUser.uid,"payrolls"),{
name:empData.name,
gross,phil,sss:Number(sss.value),tax:Number(tax.value),net
});
alert("Payroll saved!");
}

window.generatePayslip=async function(){
let snap=await getDocs(collection(db,"users",currentUser.uid,"payrolls"));
let html="";
snap.forEach(doc=>{
let d=doc.data();
if(d.name==recordEmp.value){
html+=`
<div class="payslip">
<b>Republic of the Philippines</b><br>
Gross: ₱${d.gross.toFixed(2)}<br>
PhilHealth: ₱${d.phil.toFixed(2)}<br>
SSS: ₱${d.sss.toFixed(2)}<br>
Tax: ${d.tax}%<br>
<b>Net: ₱${d.net.toFixed(2)}</b>
</div>`;
}
});
payslipOutput.innerHTML=html;
}

</script>
</body>
</html>
